---
title: 一键部署fastdfs服务
categories:
  - 运维测试
tags:
  - fastdfs
date: 2021-07-19 15:19:46
---

### 一键部署fastdfs服务

- 部署自有文件系统

- 基于docker-compose实现快捷部署

- 部署命令

  ```
  docker-compose up -d
  ```

- [项目链接地址](https://github.com/zhouyuanmin/fastdfs)

- 这是部署在单服务器上，如果需要增加storage，可以自己单独增加

### 默认配置

```python
# nginx/nginx.conf文件
listen  8888;
# tracker/conf/client.conf文件需要自己去修改
base_path=/tmp
tracker_server=公网ip:22122 
http.tracker_server_port=8888  # 需要保证nginx.conf监听端口一样
# docker-compose.yml
TRACKER_SERVER 需要修改为公网ip
```

### python客户端简单使用(测试)

```
pip install py3Fdfs
```

```python
from fdfs_client.client import Fdfs_client, get_tracker_conf
tracker_path = get_tracker_conf('tracker/conf/client.conf')
client = Fdfs_client(tracker_path)
ret = client.upload_by_filename('/Users/myard/Desktop/cover.png')
print(ret)
"""
{'Group name': b'group1', 'Remote file_id': b'group1/M00/00/00/CgAEA2D1I6qALZ3lAABu0uHYmQI601.png', 'Status': 'Upload successed.', 'Local file name': '/Users/myard/Desktop/cover.png', 'Uploaded size': '27.71KB', 'Storage IP': b'1.15.144.243'}
"""
```

### fastdfs使用技巧

##### 自定义下载文件名

```shell
# 通过增加参数 filename=xxx
# 示例
http://file.myard.cn:8888/group1/M00/00/00/CgAEA2D1KkeAY9CxAABu0uHYmQI574.png?filename=newfile.png
```





